<html>
  <head>
    <title>Bubbles</title>
    <!-- Google Adsense -->
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <!-- AutoResponse -->
    <ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-7307479428475282"
     data-ad-slot="8718898251"
     data-ad-format="auto"></ins>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
    
  </head>
  <body>
    <!-- // Bubbles -->
    <canvas id="cnv" width="800" height="600" style="border:1px solid #73AD21;border-radius:10px;">CANVAS NOT SUPPORTED</canvas>
    
  </body>
  <script>
    // Bubbles
    var c = document.getElementById("cnv");
    var ctx = c.getContext("2d");
    var colors = ["red", "orange", "yellow", "green", "blue", "indigo", "purple"];
    function _bubble(cx, cy, r, dx, dy, c) {
      this.cx = cx;
      this.cy = cy;
      this.r = r;
      this.dx = dx;
      this.dy = dy;
      this.color = c;
    }
    
    var bubbles = [];
    var cnt = Math.random() * 10 + 12;
    var cnv_w = ctx.canvas.width;
    var cnv_h = ctx.canvas.height;
    for (var i = 0; i < cnt; i++) {
      bubbles.push( 
        new _bubble(
          Math.random() * cnv_w, 
          Math.random() * cnv_h,
          Math.random() * Math.min(cnv_w, cnv_h) * 0.5,
          Math.random() * 12 - 6,
          Math.random() * 12 - 6,
          parseInt(Math.random() * colors.length)
        )
      );
    }
    
    function frame() {
      // clear
      ctx.beginPath();
      ctx.fillStyle="#fcfcfc";
      ctx.rect(0, 0, cnv_w, cnv_h);
      ctx.fill();

      for (var i = 0; i < bubbles.length; i++) {
        console.log(3);
        var b = bubbles[i];

        // draw
        ctx.globalCompositeOperation = "saturation";
        ctx.beginPath();
        //ctx.globalAlpha = 0.8;
        const g = ctx.createRadialGradient(
          b.cx, b.cy, b.r * 0.1, b.cx, b.cy, b.r * 10
        );
        g.addColorStop(0, colors[b.color]);
        g.addColorStop(1, 'transparent');

        ctx.fillStyle = g;
        ctx.arc(b.cx, b.cy, b.r, 0, 2 * Math.PI);
        ctx.fill();

        // bounce
        if ((b.cx + b.dx) < 0 || (b.cx + b.dx) >=  cnv_w) b.dx *= -1;
        if ((b.cy + b.dy) < 0 || (b.cy + b.dy) >=  cnv_h) b.dy *= -1;
        b.cx += b.dx;
        b.cy += b.dy;
      }

      requestAnimationFrame(frame);
    }
    requestAnimationFrame(frame);
  </script>
</html>
